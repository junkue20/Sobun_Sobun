<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>새로운 1인가구 공구문화 - 소분소분</title>
    <link rel="stylesheet" th:href="@{/css/bootstrap.min.css}">
    <!-- font-awesome CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
        integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />

    <!-- <link rel="stylesheet" th:href="@{/css/km/noneed_order/elegant-icons.css}" type="text/css">
     <link rel="stylesheet" th:href="@{/css/km/noneed_order/magnific-popup.css}" type="text/css">
     <link rel="stylesheet" th:href="@{/css/km/noneed_order/jquery-ui.min.css}" type="text/css">
     <link rel="stylesheet" th:href="@{/css/km/noneed_order/owl.carousel.min.css}" type="text/css">
     <link rel="stylesheet" th:href="@{/css/km/noneed_order/slicknav.min.css}" type="text/css"> -->

    <link rel="stylesheet" th:href="@{/css/km/noneed_order/checkoutstyle.css}" type="text/css">
    <link rel="stylesheet" th:href="@{/css/km/noneed_order/checkouttable.css}" type="text/css">

    <th:block th:replace="~{/se/customer/header :: headerCSS}"></th:block>
    <th:block th:replace="~{/km/customer/footer :: footerCSS}"></th:block>

    <script th:src="@{/js/bootstrap.min.js}"></script>
    <!-- axios (https://cdnjs.com/libraries/axios) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.3.5/axios.min.js"
        integrity="sha512-nnNHpffPSgINrsR8ZAIgFUIMexORL5tPwsfktOTxVYSv+AUAILuFYWES8IHl+hhIhpFGlKvWFiz9ZEusrPcSBQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <!-- 토스페이 cdn -->
    <script src="https://js.tosspayments.com/v1/payment-widget"></script>
</head>
<!-- 주문 페이지-->

<body>
    <!-- header -->
    <th:block th:replace="~{/se/customer/header :: headerHTML}"></th:block>

    <!-- 본문 영역 (padding-bottom은 건들면 안돼요ㅠㅠ footer랑 겹치는 문제 해결용임돵) -->
    <div class="checkout spad" style="padding-bottom: 300px;">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <h6 class="coupon__link">
                        <!-- <i class="fa fa-tag"></i> <a th:href="@{/customer/item/selectone.do(no=${})}" style="text-decoration: none;">이전페이지 돌아가기</a> -->
                    </h6>
                </div>
            </div>
            <form action="#" class="checkout__form">
                <div class="row" style="margin-right: 0;margin-left: 0;">

                    <!-- 주문 정보 ~ -->
                    <div class="col-lg-8 mb-4">
                        <h5>주문정보</h5>
                        <div class="row">
                            <div class="col-lg-12">
                                <div class="checkout__form__input">
                                    <p>주문하시는 분 <span>*</span></p>
                                    <input type="text">
                                </div>

                                <div class="checkout__form__input">
                                    <p>휴대전화 <span>*</span></p>
                                    <input type="text" placeholder="- 빼고 입력해주세요">
                                </div>
                                <div class="checkout__form__input">
                                    <p>이메일 <span>*</span></p>
                                    <input type="text" placeholder="Street Address">
                                </div>
                                <div class="checkout__form__input">
                                    <p>참여인원 <span>*</span></p>
                                    <input type="text" th:value="|${obj.participant}명|" readonly>
                                </div>
                                <div class="checkout__form__input">
                                    <p>수령지점 <span>*</span></p>
                                    <input type="text" th:value="${obj.storageName}" readonly>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- ~ 주문 정보 -->

                    <!-- 최종 결제 금액 ~ -->
                    <div class="col-lg-4" style="margin-top: 60px;">
                        <div class="checkout__order">
                            <h5>최종 결제 금액</h5>
                            <div class="checkout__order__product">
                                <ul>
                                    <li>
                                        <span class="top__text">카드 결제</span>
                                        <!-- <span class="top__text__right">Total</span> -->
                                    </li>
                                    <li>상품 금액 <span>5,500원</span></li>
                                    <li>배송비<span>2,200원</span></li>
                                    <!-- <li>03. Black jean <span>$ 170.0</span></li>
                                    <li>04. Cotton shirt <span>$ 110.0</span></li> -->
                                </ul>
                            </div>
                            <div class="checkout__order__total">
                                <ul>
                                    <!-- <li>Subtotal <span>$ 750.0</span></li> -->
                                    <li>Total <span id="total_price" th:text="|가나다|"></span></li>
                                </ul>
                            </div>
                            <button id="payment-button" class="site-btn">결제하기</button>
                        </div>
                    </div>
                    <!-- ~ 최종 결제 금액 -->

                    <!-- 결제 수단 ~ -->
                    <div class="col-lg-8 table_container mb-4 mt3">
                        <h5>결제수단</h5>
                        <div class="row">
                            <div class="col-lg-12">
                                <!-- 결제위젯, 이용약관 영역 -->
                                <div id="payment-method"></div>
                                <div id="agreement"></div>
                            </div>
                        </div>
                    </div>
                    <!-- ~ 결제 수단 -->

                    <!-- 상품 정보 ~ -->
                    <div class="col-lg-8 mt-3 table_container">
                        <h5 style="margin-bottom: 0;">상품정보</h5>
                        <div class="row" style="margin-top: -20px;">
                            <div class="col-lg-12">
                                <!-- 테이블 시작 ~ -->
                                <div class="container">
                                    <div class="row row--top-20">
                                        <div class="col-md-12">
                                            <div class="table-container">
                                                <table class="table">
                                                    <thead class="table__thead">
                                                        <tr>
                                                            <th class="table__th">상품정보</th>
                                                            <th class="table__th">총판매가</th>
                                                            <th class="table__th">1인당 판매가</th>
                                                            <th class="table__th">배송비</th>
                                                            <th class="table__th">합계</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody class="table__tbody">
                                                        <tr class="table-row table-row--item">
                                                            <td class="table-row__td">
                                                                <div class="table-row__img">
                                                                    <img th:src="${obj.imageUrl}" alt="">
                                                                </div>
                                                                <div class="table-row__info">
                                                                    <p class="table-row__name"
                                                                        th:text="${obj.itemName}"></p>
                                                                </div>
                                                            </td>
                                                            <td data-column="Policy" class="table-row__td">
                                                                <div class="">
                                                                    <p class="table-row__policy"
                                                                        th:text="${#numbers.formatInteger(obj.itemPrice, 3, 'COMMA') + '원'}">
                                                                    </p>
                                                                </div>
                                                            </td>
                                                            <td data-column="Policy" class="table-row__td">
                                                                <p class="table-row__policy"
                                                                    th:text="${#numbers.formatInteger(obj.pricePerOne, 3, 'COMMA') + '원'}">
                                                                </p>
                                                            </td>
                                                            <td data-column="Destination" class="table-row__td">
                                                                배송비
                                                            </td>
                                                            <td data-column="Policy" class="table-row__td">
                                                                <p class="table-row__policy">합계</p>
                                                            </td>

                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>

                                </div>
                                <!-- ~ 테이블 시작 -->
                            </div>

                        </div>
                    </div>
                    <!-- ~ 상품 정보 -->

                </div>
            </form>
        </div>
    </div>

    <!-- footer -->
    <th:block th:replace="~{/km/customer/footer :: footerHTML}"></th:block>



    <!-- script-->
    <script th:src="@{/js/jquery-3.6.4.min.js}"></script>
    <!-- 
        <script th:src="@{/js/km/noneed_order/jquery.magnific-popup.min.js}"></script> 
        <script th:src="@{/js/km/noneed_order/jquery-ui.min.js}"></script> 
        <script th:src="@{/js/km/noneed_order/mixitup.min.js}"></script> 
        <script th:src="@{/js/km/noneed_order/jquery.countdown.min.js}"></script> 
        <script th:src="@{/js/km/noneed_order/jquery.slicknav.js}"></script> 
        <script th:src="@{/js/km/noneed_order/owl.carousel.min.js}"></script> 
        <script th:src="@{/js/km/noneed_order/jquery.nicescroll.min.js}"></script> 
        <script th:src="@{/js/km/noneed_order/main.js}"></script> 
    -->

    <script th:inline="javascript" type="text/javascript">
        // 토스 페이
        // 문서 테스트 키
        // 토스페이먼츠와 계약하지 않았다면 아래 키로 결제위젯을 연동하세요.
        const clientKey = 'test_ck_D5GePWvyJnrK0W0k6q8gLzN97Eoq';
        const secretKey = 'test_sk_zXLkKEypNArWmo50nX3lmeaxYG5R';

        // const clientKey = "test_ck_D5GePWvyJnrK0W0k6q8gLzN97Eoq"
        const customerKey = "dAOmt-WNW0SAF4bZJenK_" // 내 상점의 고객을 식별하는 고유한 키

        // ------  결제위젯 초기화 ------ 
        // 비회원 결제에는 customerKey 대신 ANONYMOUS를 사용하세요.
        const paymentWidget = PaymentWidget(clientKey, customerKey) // 회원 결제
        // const paymentWidget = PaymentWidget(clientKey, PaymentWidget.ANONYMOUS) // 비회원 결제

        // ------  결제위젯 렌더링 ------ 
        // 결제위젯이 렌더링될 DOM 요소를 지정하는 CSS 선택자 및 결제 금액을 넣어주세요. 
        // https://docs.tosspayments.com/reference/widget-sdk#renderpaymentmethods선택자-결제-금액-옵션
        paymentWidget.renderPaymentMethods("#payment-method", 1)

        // ------  이용약관 렌더링 ------
        // 이용약관이 렌더링될 DOM 요소를 지정하는 CSS 선택자를 넣어주세요.
        // https://docs.tosspayments.com/reference/widget-sdk#renderagreement선택자
        paymentWidget.renderAgreement('#agreement')

        // ------ '결제하기' 버튼 누르면 결제창 띄우기 ------
        // 더 많은 결제 정보 파라미터는 결제위젯 SDK에서 확인하세요.
        // https://docs.tosspayments.com/reference/widget-sdk#requestpayment결제-정보

        document.querySelector("#payment-button").addEventListener("click", () => {
            paymentWidget.requestPayment({
                orderId: "ZvnMmoRlyMSBuxO3ROABx",            // 주문 ID(직접 만들어주세요)
                orderName: "토스 티셔츠 외 2건",                 // 주문명
                // successUrl: "http://127.0.0.1:5959/SOBUN/customer/home.do",  // 결제에 성공하면 이동하는 페이지(직접 만들어주세요)
                successUrl: "https://my-store.com/success",  // 결제에 성공하면 이동하는 페이지(직접 만들어주세요)
                failUrl: "https://my-store.com/fail",        // 결제에 실패하면 이동하는 페이지(직접 만들어주세요)
                customerEmail: "customer123@gmail.com",
                customerName: "김토스"
            }).catch(function (error) {
                if (error.code === 'USER_CANCEL') {
                    // 결제 고객이 결제창을 닫았을 때 에러 처리
                } if (error.code === 'INVALID_CARD_COMPANY') {
                    // 유효하지 않은 카드 코드에 대한 에러 처리
                }
            })
            console.log(successUrl);
        })

    </script>
</body>

</html>